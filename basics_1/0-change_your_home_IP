#!/usr/bin/env bash
# Configure /etc/hosts: localhost -> 127.0.0.2 and facebook.com -> 8.8.8.8

tmpfile="$(mktemp)"

{
  echo "127.0.0.2 localhost"
  echo "8.8.8.8 facebook.com"
  # keep everything else, but drop any previous localhost or facebook.com lines
  grep -vE '^[[:space:]]*127\.0\.0\.[0-9]+[[:space:]]+localhost([[:space:]]|$)|[[:space:]]facebook\.com([[:space:]]|$)' /etc/hosts
} > "$tmpfile"

# overwrite /etc/hosts atomically without sed -i
cat "$tmpfile" > /etc/hosts
rm -f "$tmpfile"
